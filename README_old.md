
# REST API для создания заметок

API предоставляет возможность регистрации и авторизации пользователя для последующего создания, получения, изменения и удаления им заметок и списков с ними.

- Приложение соответствует основным принципам построения чистой архитектуры, а также принципам SOLID.
- Приложение можно легко сконфигурировать и запустить локально, в докер контейнере или в докер композиции вместе с базой данных, произвести миграции.
- Авторизация реализована с применением JWT токенов, пароли сохраняются в базу данных в хешированном виде.
- Документация swagger доступна по пути `/swagger/index.html`.

## Запуск приложения

### Быстрый запуск докер композиции

Запуск докер композиции из приложения и базы данных с автоматической миграцией и тестами.

Чтобы запустить приложение:
- Создайте `.env` файл, в котором укажите переменные окружения `DB_PASSWORD` и `JWT_KEY`.
- Запустите композицию командами: `docker compose build`, `docker compose up`.

По умолчанию приложение сконфигурировано под этот вариант.

### Запуск в докер контейнере

Создание образа приложения и его запуск в докер контейнере с автоматическими тестами (требует предварительной настройки базы данных).

Чтобы запустить приложение:
- Сконфигурируйте приложение используя файл `configs/config.yaml`.
- Создайте `.env` файл, в котором укажите переменные окружения `DB_PASSWORD` и `JWT_KEY`.
- Произведите миграции, выполнив команду `migrate -path ./migrations/postgres/schemas -database {YOUR_DB_URL_HERE} up` или `make migrate`.
- Создайте образ командой `docker build -t slugs .` или `make build`.
- Запустите приложение в контейнере командой `docker run --name slugs -p 8080:{YOUR_PORT_HERE} slugs` или `make run`.
- Для удаления образа и контейнера можно использовать команду `make remove`.

### Обычный запуск

Запуск бинарной сборки приложения (требует предварительной настройки базы данных).

Чтобы запустить приложение:
- Сконфигурируйте приложение используя файл `configs/config.yaml`.
- Создайте `.env` файл, в котором укажите переменные окружения `DB_PASSWORD` и `JWT_KEY`.
- Произведите миграции, выполнив команду `migrate -path ./migrations/postgres/schemas -database {YOUR_DB_URL_HERE} up` или `make migrate`.
- Создайте бинарную сборку приложения командой `go build -o slugs cmd/main.go`.
- Запустите приложение командой `./slugs`.

Для использования `make` команд переменная окружения `DB_PASSWORD` должна иметь значение `secret`, а файл конфигурации иметь следующее содержимое:

Для обычного запуска:

```yaml
port: "8080"

db:
  username: "postgres"
  host: "localhost"
  port: "5436"
  name: "slugs"
```

Для запуска в докер контейнере:

```yaml
port: "8080"

db:
  username: "postgres"
  host: "host.docker.internal"
  port: "5436"
  name: "slugs"
```

Для быстрого создания базы данных в докер контейнере под эти конфигурации можно использовать команду `make postgres`.

## Требования

- go 1.18.2
- docker & docker-compose
- утилита make (необязательно)
- golang-migrate/migrate (необязательно)

## Лицензия

[MIT](https://choosealicense.com/licenses/mit/)
